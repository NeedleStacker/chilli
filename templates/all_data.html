<!doctype html>
<html lang="hr">
<head>
  <meta charset="utf-8">
  <title>Chilli - Svi podaci</title>
  <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.2/dist/css/bootstrap.min.css" rel="stylesheet">
  <link rel="stylesheet" href="{{ url_for('static', filename='css/styles.css') }}">
  <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
</head>
<body>
<div class="container-fluid">
  <h2 class="mb-4">ðŸ“Š Svi podaci iz baze</h2>

  <div class="mb-4">
    <label for="whereInput" class="form-label">Filter podataka (SQL WHERE uvjet, npr. <code>soil_percent &gt; 40</code>):</label>
    <div class="input-group">
      <input type="text" id="whereInput" class="form-control" value="id > 1000" placeholder="npr. air_temp > 25 AND lux < 1000">
      <button class="btn btn-primary" id="filterBtn">Primijeni filter</button>
    </div>
	<small class="form-text text-muted mb-1">Primjeri WHERE uvjeta:</small>
	<div class="d-flex flex-wrap gap-2 mb-3">
	  <button type="button" class="btn btn-sm btn-outline-secondary example-btn">id &gt; 1000</button>
	  <button type="button" class="btn btn-sm btn-outline-secondary example-btn">air_temp &gt; 25</button>
	  <button type="button" class="btn btn-sm btn-outline-secondary example-btn">soil_percent &lt; 30</button>
	  <button type="button" class="btn btn-sm btn-outline-secondary example-btn">lux &lt; 500</button>
	  <button type="button" class="btn btn-sm btn-outline-secondary example-btn">stable = 0</button>
	  <button type="button" class="btn btn-sm btn-outline-secondary example-btn"
  onclick="this.textContent = (d => `timestamp BETWEEN '${d[0]}' AND '${d[1]}'`)((() => { const t = new Date(), p = new Date(); p.setDate(t.getDate() - 30); const f = d => d.toISOString().split('T')[0]; return [f(p), f(t)]; })())">
  timestamp BETWEEN Today-30days AND Today
</button>

	</div>
  </div>

  <canvas id="airTempChart"></canvas>
  <canvas id="airHumidityChart"></canvas>
  <canvas id="soilTempChart"></canvas>
  <canvas id="soilMoistureChart"></canvas>
  <canvas id="luxChart"></canvas>

  <div class="card mb-4">
    <div class="card-body">
      <h5>ðŸ“ˆ Statistika</h5>
      <pre id="stats"></pre>
    </div>
  </div>

  <h5 class="mt-3">Brisanje podataka</h5>
  <div class="input-group mb-2">
    <input id="deleteIdsInput" type="text" class="form-control" placeholder="ID-evi npr: 1,2,3 ili 'all'">
    <button class="btn btn-danger" id="btnDeleteRows">ObriÅ¡i</button>
  </div>
  <div id="deleteStatus" class="text-muted small"></div>

  <h4 class="mt-4">Tablica svih podataka</h4>
  <div style="max-height:400px; overflow:auto;">
    <table class="table table-striped table-sm">
      <thead class="table-light">
        <tr>
          <th>ID</th><th>Vrijeme</th><th>Air T</th><th>Air H</th>
          <th>Soil T</th><th>Soil %</th><th>Lux</th><th>Stable</th>
        </tr>
      </thead>
      <tbody id="logsBody"></tbody>
    </table>
  </div>
</div>

<script src="{{ url_for('static', filename='js/all_data.js') }}" defer></script>
</body>
</html>